---
title: "Consumer Score Engine"
slug: "consumer-score-engine"
summary: "Distributed scoring pipeline for DeFi user behavior analysis"
date: "2024-03-15"
updated: "2025-10-16"
tags: ["defi", "scoring", "kafka", "neo4j", "ml"]
tech: ["Python", "Kafka", "Neo4j", "Redis", "scikit-learn"]
cover: ""
status: "production"
featured: false
---

## Overview

High-performance data pipeline processing **2M+ transactions daily** across multiple chains to generate user scores for DeFi protocols. Built with microservices architecture featuring Apache Kafka for event streaming, Neo4j for graph relationships, and ML-powered scoring with **Sub-100ms latency**.

Proprietary system powering ConsumerFi's user acquisition and risk assessment, achieving **$10M+ in prevented fraud** through Sybil detection, **95% accuracy** in credit risk prediction, and **99.95% uptime** over 12 months of production deployment.

<Terminal cmd="data pipeline architecture">
┌──────────────┐      ┌──────────────┐      ┌──────────────┐
│  Blockchain  │─────▶│    Kafka     │─────▶│  Score       │
│  Events      │      │   Streams    │      │  Engine      │
└──────┬───────┘      └──────┬───────┘      └──────┬───────┘
       │                     │                      │
       ▼                     ▼                      ▼
  ┌──────────┐          ┌──────────┐          ┌──────────┐
  │  Social  │          │  Neo4j   │          │  Redis   │
  │  APIs    │          │  Graph   │          │  Cache   │
  └──────────┘          └──────────┘          └──────────┘
</Terminal>

<Window title="scoring/calculate_user_score.py">
```python
from scoring import ScoreEngine

async def calculate_user_score(user_address: str) -> dict:
    # Real-time data aggregation from multiple sources
    on_chain = await fetch_blockchain_activity(user_address)
    social = await fetch_social_reputation(user_address)
    defi = await fetch_defi_behavior(user_address)
    network = await fetch_network_effects(user_address)

    # ML-powered scoring across 4 dimensions
    scores = {
        "on_chain": score_on_chain_activity(on_chain),      # 0-100
        "social": score_social_reputation(social),          # 0-100
        "defi": score_defi_behavior(defi),                  # 0-100
        "network": score_network_effects(network),          # 0-100
    }

    # Weighted composite score with risk assessment
    composite = (
        scores["on_chain"] * 0.30 +
        scores["social"] * 0.20 +
        scores["defi"] * 0.35 +
        scores["network"] * 0.15
    )

    # Cache result for sub-100ms retrieval
    await redis.setex(f"score:{user_address}", 3600, composite)

    return {"score": composite, "breakdown": scores}
```
</Window>

**Links:**
- Proprietary system developed for ConsumerFi
- Case studies available for institutional clients
- **Detected 2000+ Sybil accounts** preventing $500K+ fraud
